#!/bin/bash

# find ide version
source /etc/version50 2>/dev/null
if [ "$version" == "" ]; then
    declare version="n/a"
fi

# ask lsof if port 8080 is open, will return 0 if so, 1 otherwise
if [ $(lsof -i :8080 >/dev/null)$? == 0 ]; then
    listening="true"
else
    listening="false"
fi

# is apache running?
if [ $(service apache2 status >/dev/null)$? == 0 ]; then
    apache="Running"
else
    apache="Not running"
fi

printf '{"version":"%s","host":"%s","listening":%s,"apache":"%s"}' "$version" "$C9_HOSTNAME" "$listening" "$apache"
